/*
 * jQuery UI Menu 1.9m6
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Menu
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(a){var b=0;a.widget("ui.menu",{version:"1.9m6",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){this.activeMenu=this.element,this.menuId=this.element.attr("id")||"ui-menu-"+b++,this.element.find(".ui-icon").length&&this.element.addClass("ui-menu-icons"),this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",a.proxy(function(a){this.options.disabled&&a.preventDefault()},this)),this._bind({"click .ui-menu-item:has(a)":function(b){b.stopImmediatePropagation();var c=a(b.currentTarget);(!this.active||this.active[0]!==c[0])&&this.focus(b,c),this.select(b)},"mouseover .ui-menu-item":function(b){b.stopImmediatePropagation();var c=a(b.currentTarget);c.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)},mouseleave:"_mouseleave","mouseleave .ui-menu":"_mouseleave","mouseout .ui-menu-item":"blur",focus:function(b){this.focus(b,a(b.target).children(".ui-menu-item:first"))},blur:"collapseAll"}),this.refresh(),this.element.attr("tabIndex",0),this._bind({keydown:function(b){switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.HOME:this._move("first","first",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.END:this._move("last","last",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.UP:this.previous(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.DOWN:this.next(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.LEFT:this.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.RIGHT:this.expand(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.ENTER:this.active.children("a[aria-haspopup='true']").length?this.expand(b)&&b.stopImmediatePropagation():(this.select(b),b.stopImmediatePropagation()),b.preventDefault();break;case a.ui.keyCode.ESCAPE:this.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;default:b.stopPropagation(),clearTimeout(this.filterTimer);var c;c=this.previousFilter||"";var e=String.fromCharCode(b.keyCode),f=!1;e==c?f=!0:e=c+e;var g=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};c=this.activeMenu.children(".ui-menu-item").filter(function(){return RegExp("^"+g(e),"i").test(a(this).children("a").text())}),c=f&&c.index(this.active.next())!=-1?this.active.nextAll(".ui-menu-item"):c,c.length||(e=String.fromCharCode(b.keyCode),c=this.activeMenu.children(".ui-menu-item").filter(function(){return RegExp("^"+g(e),"i").test(a(this).children("a").text())})),c.length?(this.focus(b,c),c.length>1?(this.previousFilter=e,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}}}),this._bind(document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b)}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show(),this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var b=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),c=this.menuId;b.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(a){return c+"-"+a}),b.each(function(){var b=a(this),c=b.prev("a");c.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>'),b.attr("aria-labelledby",c.attr("id"))})},focus:function(b,c){this.blur(b);if(this._hasScroll()){var e=parseFloat(a.curCSS(this.activeMenu[0],"borderTopWidth",!0))||0,f=parseFloat(a.curCSS(this.activeMenu[0],"paddingTop",!0))||0;e=c.offset().top-this.activeMenu.offset().top-e-f,f=this.activeMenu.scrollTop();var g=this.activeMenu.height(),h=c.height();e<0?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h)}this.active=c.first().children("a").addClass("ui-state-focus").end(),this.element.attr("aria-activedescendant",this.active.children("a").attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),this.timer=this._delay(function(){this._close()},this.delay),e=a(">ul",c),e.length&&/^mouse/.test(b.type)&&this._startOpening(e),this.activeMenu=c.parent(),this._trigger("focus",b,{item:c})},blur:function(a){this.active&&(clearTimeout(this.timer),this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),a.attr("aria-hidden")==="true"&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents()).hide().attr("aria-hidden","true");var c=a.extend({},{of:this.active},a.type(this.options.position)=="function"?this.options.position(this.active):this.options.position);b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b){var c=!1;if(b){var e=a(b.target);e.is("ui.menu")?c=e:e.closest(".ui-menu").length&&(c=e.closest(".ui-menu"))}this._close(c),c||(this.blur(b),this.activeMenu=this.element)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(b&&b.length)return this._close(),this.focus(a,b),!0},expand:function(a){var b=this.active&&this.active.children("ul").children("li").first();if(b&&b.length)return this._open(b.parent()),this._delay(function(){this.focus(a,b)},20),!0},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){this.active?(a=a==="first"||a==="last"?this.active[a==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0),a.length?this.focus(c,a):this.focus(c,this.activeMenu.children(".ui-menu-item")[b]())):this.focus(c,this.activeMenu.children(".ui-menu-item")[b]())},nextPage:function(b){if(this._hasScroll())if(this.active){if(!this.last()){var c=this.active.offset().top,e=this.element.height(),f;this.active.nextAll(".ui-menu-item").each(function(){return f=a(this),a(this).offset().top-c-e<0}),this.focus(b,f)}}else this.focus(b,this.activeMenu.children(".ui-menu-item").first());else this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(b){if(this._hasScroll())if(this.active){if(!this.first()){var c=this.active.offset().top,e=this.element.height(),f;this.active.prevAll(".ui-menu-item").each(function(){return f=a(this),a(this).offset().top-c+e>0}),this.focus(b,f)}}else this.focus(b,this.activeMenu.children(".ui-menu-item").first());else this.focus(b,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.height()<this.element.prop("scrollHeight")},_mouseleave:function(a){this.collapseAll(a),this.blur()},select:function(a){var b={item:this.active};this.collapseAll(a),this._trigger("select",a,b)}})})(jQuery)